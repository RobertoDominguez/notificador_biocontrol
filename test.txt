use Bioapp

select top 10 * from acc.AccessLog where TerminalName = 'AYACUCHO' AND id = 355842 or id = 7677 or id = 7678

select top 10 * from bio.Terminal

update acc.AccessLog set UserCode = '8578649' where id = 7678

--AYACUCHO
update acc.AccessLog set mostrado = 0 where id = 7677

update acc.AccessLog set mostrado = 0 where id = 7709
update acc.AccessLog set abierto = 0 where id = 7709


-- Colegio Aleman
update acc.AccessLog set mostrado = 0 where id = 355842


select * from acc.AccessLog where id = 7709



update acc.AccessLog set TerminalName = 'JUNIN' where id=355841


select * from bio.Terminal

select t.Guid, t.Code, t.Name,t.GroupId FROM bio.Terminal as t,acc."Group" as g where t.GroupId=g.Id AND g.Name='Grupo Roes'

SELECT top 1 UserCode,DateTime,TerminalCode,Allowed,TerminalName,TerminalIP FROM acc.AccessLog WHERE mostrado = 0 AND TerminalName = 'AYACUCHO'






--------------------------------------------------------------------------------------------------------------------------


ALTER TABLE acc.AccessLog add mostrado bit default 0;

alter table acc.accesslog drop column mostrado

select top 1000 * from acc.AccessLog

select top 1000 * from acc."User"

select top 1000 *
from acc.AccessLog as a
JOIN acc."User" as u
ON a.UserCode=u.Code
where a.id = 7709


update acc.AccessLog set UserCode = '8578649' where id = 7709

update acc."User" set Code = '8578649' where id = 1362


update acc."User" set Meta = '{"role": "2","hasPassword":"false","hasFingerPrint":"false","hasBioPhoto":"true","photoFileName":"13d70fe5-52ae-4fd1-8fb2-2581c9984cf9"}' where id = 1362









-----------------------------------------------------------

use GymControl

--select CAST(GETDATE() AS DATE);

SELECT c.codigo, CONCAT(c.nombres,' ',c.apellidos) as nombre_completo , p.nombre as membresia,
            v.fecha_desde, v.fecha_hasta, p.nombre as nombre_paquete,'' as suc_nombre,
			CASE WHEN  fecha_desde <= CAST(GETDATE() AS DATE)
			AND fecha_hasta >= CAST(GETDATE() AS DATE) THEN 1 else 0 END as habilitado
            FROM Venta as v JOIN Paquete as p ON v.id_paquete = p.id JOIN Cliente as c ON c.id = v.id_cliente 
            WHERE v.cancelado = 1 AND v.anulado = 0
			AND c.codigo = '14072904'

use Access

select * from acc_monitor_log order by id desc


update acc_monitor_log set abierto = 0, mostrado = 0, pin = '14072904' where id = 1437

update acc_monitor_log set abierto = 0, mostrado = 0, pin = '14072904' where id = 1438

select * from acc_monitor_log where id = 1437

SELECT TOP 1 a.id,a.pin,a.time,m.sn,a.device_name,1 as Allowed,m.ip,'' as meta
FROM Acc_monitor_log as a
JOIN Machines as m ON a.device_id = m.id
WHERE a.mostrado = 0 AND a.device_name = %s",(terminal,)

select * from Machines











----------------------- MINI SQL ------------------------------
use AXData

-- personas
select EmployeeName,EnglishName,count(*) from TEmployee group by  EmployeeName,EnglishName having count(*) > 1
select * from TEmployee where EmployeeName LIKE '%VICTORIA'
-- dispositivos
select * from TControl
-- marcaciones
select TOP 1000 * from TEvent order by EventID desc

update TControl set Name = 'Terminal_3' where orden = 3


select ISNULL('a', '') + ' ' + ISNULL('', '')

SELECT TOP 100 e.EventID,e.CardNo,e.EventTime,c.Code,1 as allowed,c.Name,c.IP,'' as meta,
p.CardNo,ISNULL(p.EmployeeName, '') + ' ' + ISNULL(p.EnglishName, '') AS NombreCompleto,'membresia' as membresia,p.RegDate,p.EndDate,'paquete' as nombre_paquete,'' as suc_nombre,
CASE 
        WHEN DATEADD(day, DATEDIFF(day, 0, p.RegDate), 0) <= DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0)
         AND DATEADD(day, DATEDIFF(day, 0, p.EndDate), 0) >= DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0)
        THEN 1 
        ELSE 0 
    END as habilitado
FROM TEvent as e
JOIN TControl as c ON e.ControlID = c.ControlID
JOIN TEmployee as p ON e.CardNo = p.CardNo
WHERE p.deleted = 0 
AND e.mostrado = 0



AND c.Name = '%%'

--1F7184
UPDATE TEvent set mostrado = 0, EventType = 6 where EventID = 803958 or EventID = 804797


select *
FROM TEvent as e
JOIN TControl as c ON e.ControlID = c.ControlID
JOIN TEmployee as p ON e.EmployeeID = p.EmployeeID
where EventID = 803958

--     16090674     

select * from TEmployee where cardNo=10004612 or CardNo=16707001

select top 100  * from TEvent where mostrado = 0








